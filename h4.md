# h4 - Maailma kuulee

# VPS-perusasetukset – Turvallinen aloitus DigitalOceanilla

Tiivistelmä Susanna Lehdon (2022) ja Tero Karvisen (2017) ohjeista uudelle Debian-pohjaiselle VPS:lle.

## Sisällysluettelo

- [1. Palvelimen hankinta ja domain (kohdat a)](#1-palvelimen-hankinta-ja-domain-kohta-a)
- [2. Palomuuri (kohdat d)](#2-palomuuri-kohta-d)
- [3. Kotisivut palvelimelle (kohdat e)](#3-kotisivut-palvelimelle-kohta-e)
- [4. Ohjelmien päivitys (kohdat f)](#4-ohjelmien-päivitys-kohta-f)
- [5. Tärkeimmät turvallisuusvaiheet (Tero Karvinen)](#5-tärkeimmät-turvallisuusvaiheet-tero-karvinen)
- [Muistilista – Tee järjestyksessä](#muistilista--tee-järjestyksessä)

## 1. Palvelimen hankinta ja domain (kohta a)

- **DigitalOcean** (GitHub Student Pack → 100 $ krediittiä)
  - Rekisteröidy → syötä maksutiedot + 1 $ varmistusmaksu (palautetaan)
  - Luo **droplet** / **server**:
    - OS: Debian 11 (tai uudempi)
    - Paketti: Basic, 1 GB RAM / 25 GB SSD / ~5 $/kk
    - Alue: lähin EU (esim. Amsterdam / Frankfurt)
    - Auth: salasana (SSH-avain suositeltu myöhemmin)

- **Domain** (Namecheap .me ilmaiseksi opiskelijalle 1 vuosi)
  - Rekisteröidy GitHub-tunnuksilla → osta domain
  - Advanced DNS → poista vanhat records
  - Lisää **A record**: `@` → palvelimen IP-osoite (esim. 188.166.4.6), TTL 300–600 s

## 2. Palomuuri (kohta d)

```bash
sudo apt-get update
sudo apt-get install ufw
sudo ufw allow 22/tcp          # SSH – ehdottoman tärkeä!
sudo ufw enable                # vahvista y + Enter
```

## 3. Kotisivut palvelimelle (kohta e)
```
# 1. Luo tavallinen käyttäjä + sudo-oikeudet
sudo adduser suska              # vaihda nimeesi
sudo adduser suska sudo

# 2. Lukitse root-käyttäjä
sudo usermod --lock root

# 3. Päivitykset
sudo apt-get update
sudo apt-get upgrade

# 4. Asenna Apache + avaa portti
sudo apt-get install apache2
sudo ufw allow 80/tcp

# 5. Nopea testi (juurisivu)
echo "<h1>Hello world!</h1>" | sudo tee /var/www/html/index.html

# 6. Vaihtoehto: käyttäjän oma ~/public_html
sudo a2enmod userdir
sudo systemctl restart apache2

mkdir ~/public_html
echo "<h1>Oma sivu</h1>" > ~/public_html/index.html
# → näkyy: http://domain.fi/~suska/
```

## 4. Ohjelmien päivitys (kohta f)
Säännölliset päivitykset ovat tietoturvan perusta:
```
sudo apt-get update
sudo apt-get upgrade
# Tarvittaessa myös:
sudo apt-get dist-upgrade
```

## 5. Tärkeimmät turvallisuusvaiheet (Tero Karvinen)
```
# Kirjaudu rootilla ensimmäisen kerran
ssh root@palvelimen-ip

# Palomuuri (jo yllä)

# Uusi käyttäjä (jo yllä)

# Estä root SSH-kirjautuminen
sudoedit /etc/ssh/sshd_config
# Muuta: PermitRootLogin no
sudo systemctl restart ssh     # tai sudo service ssh restart

# Päivitykset (jo yllä)

# Web-portti (jos käytät Apachea)
sudo ufw allow 80/tcp
```

## Muistilista – Tee järjestyksessä

Hanki palvelin + domain, aseta A-record

Kirjaudu rootilla → asenna & ota palomuuri käyttöön (allow 22!)

Luo oma sudo-käyttäjä → testaa SSH-yhteys sillä

Lukitse root + estä root-SSH (PermitRootLogin no)

Tee päivitykset (update + upgrade)

Asenna Apache + avaa portti 80

Laita sivut /var/www/html tai ~/public_html

Pidä järjestelmä ajan tasalla säännöllisesti
